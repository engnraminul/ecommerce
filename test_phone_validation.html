<!DOCTYPE html>
<html>
<head>
    <title>Phone Number Validation Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test-case { margin: 10px 0; padding: 10px; border: 1px solid #ccc; }
        .success { background-color: #d4edda; border-color: #c3e6cb; }
        .error { background-color: #f8d7da; border-color: #f5c6cb; }
        input { padding: 8px; margin: 5px; width: 200px; }
        .field-error { color: red; font-size: 12px; }
    </style>
</head>
<body>
    <h1>Phone Number Validation Test</h1>
    
    <div>
        <h3>Test Input:</h3>
        <input type="tel" id="test-phone" placeholder="Try: +8801777173040">
        <button onclick="testPhone()">Test</button>
        <div id="result"></div>
    </div>
    
    <h3>Test Cases:</h3>
    <div id="test-cases"></div>
    
    <script>
        // Phone number validation and normalization functions
        function normalizePhoneNumber(phone) {
            if (!phone) return '';
            
            // Remove all non-digit characters
            let digits = phone.replace(/\D/g, '');
            
            // Handle different formats
            if (digits.startsWith('880')) {
                // Remove country code 880 and add 0 prefix
                digits = '0' + digits.substring(3);
            } else if (digits.startsWith('88')) {
                // Remove country code 88 and add 0 prefix  
                digits = '0' + digits.substring(2);
            } else if (!digits.startsWith('0')) {
                // Add 0 prefix if not present
                digits = '0' + digits;
            }
            
            return digits;
        }
        
        function validatePhoneNumber(phone) {
            const normalized = normalizePhoneNumber(phone);
            
            // Check if normalized phone has at least 11 digits
            if (normalized.length < 11) {
                return {
                    isValid: false,
                    normalized: normalized,
                    error: 'Phone number must be at least 11 digits'
                };
            }
            
            // Check if it's a valid Bangladesh number (starts with 01)
            if (!normalized.startsWith('01')) {
                return {
                    isValid: false,
                    normalized: normalized,
                    error: 'Please enter a valid Bangladesh phone number'
                };
            }
            
            // Limit to 11 digits for Bangladesh mobile numbers
            const finalNumber = normalized.substring(0, 11);
            
            return {
                isValid: true,
                normalized: finalNumber,
                error: null
            };
        }
        
        function testPhone() {
            const input = document.getElementById('test-phone').value;
            const result = validatePhoneNumber(input);
            
            document.getElementById('result').innerHTML = `
                <div class="${result.isValid ? 'success' : 'error'}" style="margin: 10px 0; padding: 10px;">
                    <strong>Input:</strong> ${input}<br>
                    <strong>Normalized:</strong> ${result.normalized}<br>
                    <strong>Valid:</strong> ${result.isValid}<br>
                    ${result.error ? `<strong>Error:</strong> ${result.error}` : ''}
                </div>
            `;
        }
        
        // Test cases
        const testCases = [
            '+8801777173040',
            '8801777173040',
            '01777173040',
            '01777-173040',
            '01777 173040',
            '(+88) 01777173040',
            '+88 01777-173040',
            '(+880) 1777-173040',
            '0177-7173040',
            '+880-1777-173040',
            '1777173040',
            '017771730', // Too short
            '02777173040', // Invalid prefix
        ];
        
        function runAllTests() {
            const container = document.getElementById('test-cases');
            container.innerHTML = '';
            
            testCases.forEach((testCase, index) => {
                const result = validatePhoneNumber(testCase);
                const expected = '01777173040';
                const isCorrect = result.isValid && result.normalized === expected;
                
                container.innerHTML += `
                    <div class="test-case ${isCorrect || (!result.isValid && ['017771730', '02777173040'].includes(testCase)) ? 'success' : 'error'}">
                        <strong>Test ${index + 1}:</strong> ${testCase}<br>
                        <strong>Normalized:</strong> ${result.normalized}<br>
                        <strong>Valid:</strong> ${result.isValid}<br>
                        <strong>Expected:</strong> ${expected}<br>
                        ${result.error ? `<strong>Error:</strong> ${result.error}<br>` : ''}
                        <strong>Result:</strong> ${isCorrect || (!result.isValid && ['017771730', '02777173040'].includes(testCase)) ? '✅ PASS' : '❌ FAIL'}
                    </div>
                `;
            });
        }
        
        // Run tests on page load
        window.onload = runAllTests;
    </script>
</body>
</html>