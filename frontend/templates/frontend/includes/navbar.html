{% load static %}

<!-- Professional Navbar -->
<header class="navbar-wrapper">
    <!-- Top Bar -->
    <div class="navbar-top">
        <div class="container">
            <div class="top-bar-content">
                <div class="top-bar-left">
                    <span class="contact-info">
                        <p><i class="fas fa-phone"></i> <a style="color: var(--light-color); text-decoration: none;" href="tel:{{ site_settings.contact_phone|default:'01777173040' }}">
                            {{ site_settings.contact_phone|default:"01777173040" }}
                        </a></p>
                        
                    </span>
                    <span class="contact-info">
                        <p><i class="fas fa-envelope"></i>  <a style="color: var(--light-color); text-decoration: none;" href="mailto:{{ site_settings.contact_email|default:'contact@manobbazar.com' }}">
                            {{ site_settings.contact_email|default:"contact@manobbazar.com" }}
                        </a>
                    </p>
                    </span>
                </div>
                <div class="top-bar-right">
                    <div class="language-selector">
                        <i class="fas fa-globe"></i>
                        <select>
                            <option>English</option>
                            <option>Spanish</option>
                            <option>French</option>
                        </select>
                    </div>
                    <div class="currency-selector">
                        <i class="fas fa-dollar-sign"></i>
                        <select>
                            <option>USD</option>
                            <option>EUR</option>
                            <option>GBP</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Navigation -->
    <nav class="navbar-main">
        <div class="container">
            <div class="navbar-content">
                <!-- Logo -->
                <div class="navbar-brand">
                    <a href="{% url 'frontend:home' %}" class="brand-logo">
                        <div class="main-logo">
                            <img src="{{ site_settings.site_logo }}" alt="{{ site_settings.site_name }}" style="max-height: 40px;">
                        </div>
                    </a>
                </div>

                <!-- Search Bar -->
                <div class="navbar-search">
                    <form class="search-form" method="get" action="{% url 'frontend:search' %}" id="mainSearchForm">
                        <div class="search-input-wrapper">
                            <div class="search-category">
                                <select name="category" class="category-select" id="categorySelect">
                                    <option value="">All Categories</option>
                                    {% for category in navbar_categories %}
                                    <option value="{{ category.slug }}">{{ category.name }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="search-divider"></div>
                            <input type="text" 
                                   name="q" 
                                   class="search-input" 
                                   id="mainSearchInput"
                                   placeholder="Search for products..." 
                                   value="{{ request.GET.q }}"
                                   autocomplete="off"
                                   autocapitalize="off"
                                   spellcheck="false">
                            <button type="submit" class="search-button" id="searchSubmitBtn">
                                <i class="fas fa-search"></i>
                            </button>
                            
                            <!-- Search Suggestions Dropdown -->
                            <div class="search-suggestions" id="searchSuggestions">
                                <!-- Search suggestions will be populated here by JavaScript -->
                            </div>
                        </div>
                    </form>
                </div>

                <!-- User Actions -->
                <div class="navbar-actions">
                    <!-- Desktop Actions -->
                    <div class="desktop-actions">
                        <!-- User Account -->
                        <div class="action-item user-account">
                            {% if user.is_authenticated %}
                                <div class="user-dropdown">
                                    <button class="user-trigger">
                                        <div class="user-avatar">
                                            {% if user.profile.avatar %}
                                                <img src="{{ user.profile.avatar.url }}" alt="Avatar">
                                            {% else %}
                                                <i class="fas fa-user"></i>
                                            {% endif %}
                                        </div>
                                        <div class="user-info">
                                            <span class="user-name">{{ user.first_name|default:user.username }}</span>
                                            <span class="user-role">My Account</span>
                                        </div>
                                        <i class="fas fa-chevron-down"></i>
                                    </button>
                                    <div class="user-menu">
                                        <a href="{% url 'frontend:dashboard' %}" class="menu-item">
                                            <i class="fas fa-tachometer-alt"></i> Dashboard
                                        </a>
                                        <a href="{% url 'frontend:profile' %}" class="menu-item">
                                            <i class="fas fa-user"></i> Profile
                                        </a>
                                        <a href="{% url 'frontend:orders' %}" class="menu-item">
                                            <i class="fas fa-box"></i> Orders
                                        </a>
                                        <a href="{% url 'frontend:wishlist' %}" class="menu-item">
                                            <i class="fas fa-heart"></i> Wishlist
                                        </a>
                                        <a href="#" class="menu-item">
                                            <i class="fas fa-cog"></i> Settings
                                        </a>
                                        <div class="menu-divider"></div>
                                        <form action="{% url 'frontend:logout' %}" method="post" style="display:inline;" id="dropdown-logout-form">
                                            {% csrf_token %}
                                            <a href="#" onclick="document.getElementById('dropdown-logout-form').submit(); return false;" class="menu-item logout">
                                                <i class="fas fa-sign-out-alt"></i> Logout
                                            </a>
                                        </form>
                                    </div>
                                </div>
                            {% else %}
                                <div class="auth-buttons">
                                    <a href="{% url 'frontend:login' %}" class="auth-btn login-btn">
                                        <i class="fas fa-sign-in-alt"></i>
                                        <span>Login</span>
                                    </a>
                                    <a href="{% url 'frontend:register' %}" class="auth-btn register-btn">
                                        <i class="fas fa-user-plus"></i>
                                        <span>Register</span>
                                    </a>
                                </div>
                            {% endif %}
                        </div>

                        <!-- Wishlist -->
                        <div class="action-item wishlist">
                            <a href="{% url 'frontend:wishlist' %}" class="action-link">
                                <div class="action-icon">
                                    <i class="fas fa-heart"></i>
                                    <span class="action-badge wishlist-count" style="display: flex !important; visibility: visible !important; opacity: 1 !important;">0</span>
                                </div>
                                <div class="action-text">
                                    <span class="action-label">Wishlist</span>
                                    <span class="action-count wishlist-items">0 items</span>
                                </div>
                            </a>
                        </div>

                        <!-- Shopping Cart -->
                        <div class="action-item cart">
                            <a href="{% url 'frontend:cart' %}" class="action-link cart-link">
                                <div class="action-icon">
                                    <i class="fas fa-shopping-cart"></i>
                                    <span style="display: flex !important; visibility: visible !important; opacity: 1 !important;" class="action-badge cart-count">0</span>
                                </div>
                                <div class="action-text">
                                    <span class="action-label">Cart</span>
                                    <span class="action-count cart-total">৳0.00</span>
                                </div>
                            </a>
                            
                            <!-- Cart Dropdown -->
                            <div class="cart-dropdown">
                                <div class="cart-dropdown-header">
                                    <h4>Shopping Cart</h4>
                                    <span class="cart-items-count">0 items</span>
                                </div>
                                <div class="cart-dropdown-body">
                                    <div class="empty-cart">
                                        <i class="fas fa-shopping-cart"></i>
                                        <p>Your cart is empty</p>
                                        <a href="{% url 'frontend:products' %}" class="btn-shop-now">Shop Now</a>
                                    </div>
                                    <!-- Cart items will be loaded here via JavaScript -->
                                </div>
                                <div class="cart-dropdown-footer">
                                    <div class="cart-total-display">
                                        <span>Total: <strong class="total-amount">৳0.00</strong></span>
                                    </div>
                                    <div class="cart-actions">
                                        <a href="{% url 'frontend:cart' %}" class="btn btn-outline">View Cart</a>
                                        <a href="{% url 'frontend:checkout' %}" class="btn btn-primary">Checkout</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Mobile Actions -->
                    <div class="mobile-actions">
                        <!-- Mobile Cart -->
                        <div class="mobile-cart">
                            <a href="{% url 'frontend:cart' %}" class="mobile-cart-link">
                                <div class="mobile-cart-icon">
                                    <i class="fas fa-shopping-cart"></i>
                                    <span class="mobile-cart-badge">0</span>
                                </div>
                            </a>
                        </div>

                        <!-- Mobile Search -->
                        <div class="mobile-search">
                            <button class="mobile-search-btn" id="mobileSearchToggle">
                                <div class="mobile-search-icon">
                                    <i class="fas fa-search"></i>
                                </div>
                            </button>
                        </div>

                        <!-- Mobile Menu Toggle -->
                        <div class="mobile-menu-toggle">
                            <button class="menu-toggle-btn" id="mobileMenuToggle">
                                <div class="hamburger-container">
                                    <span class="hamburger"></span>
                                    <span class="hamburger"></span>
                                    <span class="hamburger"></span>
                                </div>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Navigation Menu -->
    <div class="navbar-menu">
        <div class="container">
            <div class="menu-content">
                <!-- Category Menu -->
                <div class="category-menu">
                    <button class="category-trigger">
                        <i class="fas fa-bars"></i>
                        <span>All Categories</span>
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="category-dropdown">
                        <div class="category-list">
                            {% for category in navbar_categories %}
                            <a href="{% url 'frontend:category_products' category.slug %}" class="category-item">
                                {% if category.image_url %}
                                    <img src="{{ category.image_url }}" alt="{{ category.name }}" class="category-icon-image" style="width: 25px;">
                                {% else %}
                                    <i class="fas fa-tag"></i>
                                {% endif %}
                                <span>{{ category.name }}</span>
                                <i class="fas fa-chevron-right"></i>
                            </a>
                            {% empty %}
                            <div class="category-item">
                                <i class="fas fa-info-circle"></i>
                                <span>No categories available</span>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>

                <!-- Main Navigation Links -->
                <nav class="main-nav">
                    <ul class="nav-links">
                        <li class="nav-item">
                            <a href="{% url 'frontend:home' %}" class="nav-link {% if request.resolver_match.url_name == 'home' %}active{% endif %}">
                                Home
                            </a>
                        </li>
                    
                        <li class="nav-item product-dropdown">
                            <a href="{% url 'frontend:products' %}" class="nav-link product-nav {% if request.resolver_match.url_name == 'product' %}active{% endif %}">
                                Product
                                <i class="fas fa-chevron-down"></i>
                            </a>
                            <div class="product-dropdown-menu">
                                <div class="product-dropdown-content">
                                    <div class="product-dropdown-section">
                                        <h5>Featured</h5>
                                        <a href="{% url 'frontend:products' %}?featured=true">Featured Products</a>
                                        <a href="{% url 'frontend:products' %}?new=true">New Arrivals</a>
                                        <a href="{% url 'frontend:products' %}?sale=true">Sale Items</a>
                                    </div>
                                    <div class="product-dropdown-section">
                                        <h5>Categories</h5>
                                        {% for category in navbar_categories|slice:":5" %}
                                        <a href="{% url 'frontend:category_products' category.slug %}">{{ category.name }}</a>
                                        {% endfor %}
                                        {% if navbar_categories|length > 5 %}
                                        <a href="{% url 'frontend:categories' %}">View All Categories</a>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                        </li>
                        <li class="nav-item">
                            <a href="{% url 'frontend:categories' %}" class="nav-link {% if request.resolver_match.url_name == 'categories' %}active{% endif %}">
                                Categories
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="{% url 'frontend:reviews' %}" class="nav-link {% if request.resolver_match.url_name == 'reviews' %}active{% endif %}">
                                Reviews
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="{% url 'frontend:about' %}" class="nav-link {% if request.resolver_match.url_name == 'about' %}active{% endif %}">
                                About
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="{% url 'contact_app:contact_page' %}" class="nav-link {% if 'contact' in request.path %}active{% endif %}">
                                Contact
                            </a>
                        </li>
                    </ul>
                </nav>

                <!-- Promotional Banner -->
                <div class="promo-banner">
                    <div class="promo-content">
                        <i class="fas fa-shipping-fast"></i>
                        <span>FREE SHIPPING on orders over ৳2000</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile Menu Overlay -->
    <div class="mobile-menu-overlay" id="mobileMenuOverlay">
        <div class="mobile-menu" id="mobileMenu">
            <div class="mobile-menu-header">
                <div class="mobile-brand-logo">
                    <a href="{% url 'frontend:home' %}" class="mobile-brand-link">
                        <div class="mobile-logo-icon">
                            <img src="{{ site_settings.site_logo }}" alt="{{ site_settings.site_name }}" style="max-height: 35px;">
                        </div>
                        
                    </a>
                </div>
                <button class="mobile-menu-close" id="mobileMenuClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="mobile-menu-body">
                <!-- User Profile Section (if authenticated) -->
                {% if user.is_authenticated %}
                <div class="mobile-user-section">
                    <div class="mobile-user-profile">
                        <div class="mobile-user-avatar">
                            {% if user.profile.avatar %}
                                <img src="{{ user.profile.avatar.url }}" alt="Avatar">
                            {% else %}
                                <i class="fas fa-user"></i>
                            {% endif %}
                        </div>
                        <div class="mobile-user-info">
                            <span class="mobile-user-name">{{ user.first_name|default:user.username }}</span>
                            <span class="mobile-user-email">{{ user.email }}</span>
                        </div>
                    </div>
                    <div class="mobile-user-stats">
                        <div class="mobile-stat">
                            <span class="stat-number cart-count">0</span>
                            <span class="stat-label">Cart Items</span>
                        </div>
                        <div class="mobile-stat">
                            <span class="stat-number wishlist-count">0</span>
                            <span class="stat-label">Wishlist</span>
                        </div>
                    </div>
                </div>
                {% endif %}
                
                <!-- Mobile Navigation -->
                <nav class="mobile-nav">
                    <div class="mobile-nav-section">
                        <h4 class="mobile-nav-title">Menu</h4>
                        <a href="{% url 'frontend:home' %}" class="mobile-nav-link {% if request.resolver_match.url_name == 'home' %}active{% endif %}">
                            <div class="mobile-nav-icon">
                                <i class="fas fa-home"></i>
                            </div>
                            <span>Home</span>
                            <i class="fas fa-chevron-right"></i>
                        </a>
                        
                        <a href="{% url 'frontend:products' %}" class="mobile-nav-link {% if request.resolver_match.url_name == 'products' %}active{% endif %}">
                            <div class="mobile-nav-icon">
                                <i class="fas fa-shopping-bag"></i>
                            </div>
                            <span>Products</span>
                            <i class="fas fa-chevron-right"></i>
                        </a>
                        
                        <a href="{% url 'frontend:categories' %}" class="mobile-nav-link {% if request.resolver_match.url_name == 'categories' %}active{% endif %}">
                            <div class="mobile-nav-icon">
                                <i class="fas fa-th-large"></i>
                            </div>
                            <span>Categories</span>
                            <i class="fas fa-chevron-right"></i>
                        </a>
                        
                        <a href="{% url 'frontend:reviews' %}" class="mobile-nav-link {% if request.resolver_match.url_name == 'reviews' %}active{% endif %}">
                            <div class="mobile-nav-icon">
                                <i class="fas fa-star"></i>
                            </div>
                            <span>Reviews</span>
                            <i class="fas fa-chevron-right"></i>
                        </a>
                        
                        <a href="{% url 'frontend:about' %}" class="mobile-nav-link {% if request.resolver_match.url_name == 'about' %}active{% endif %}">
                            <div class="mobile-nav-icon">
                                <i class="fas fa-info-circle"></i>
                            </div>
                            <span>About</span>
                            <i class="fas fa-chevron-right"></i>
                        </a>
                        
                        <a href="{% url 'contact_app:contact_page' %}" class="mobile-nav-link {% if 'contact' in request.path %}active{% endif %}">
                            <div class="mobile-nav-icon">
                                <i class="fas fa-envelope"></i>
                            </div>
                            <span>Contact</span>
                            <i class="fas fa-chevron-right"></i>
                        </a>
                    </div>
                    
                    {% if user.is_authenticated %}
                        <div class="mobile-nav-section">
                            <h4 class="mobile-nav-title">Account</h4>
                            <a href="{% url 'frontend:dashboard' %}" class="mobile-nav-link">
                                <div class="mobile-nav-icon">
                                    <i class="fas fa-tachometer-alt"></i>
                                </div>
                                <span>Dashboard</span>
                                <i class="fas fa-chevron-right"></i>
                            </a>
                            <a href="{% url 'frontend:profile' %}" class="mobile-nav-link">
                                <div class="mobile-nav-icon">
                                    <i class="fas fa-user"></i>
                                </div>
                                <span>Profile</span>
                                <i class="fas fa-chevron-right"></i>
                            </a>
                            <a href="{% url 'frontend:orders' %}" class="mobile-nav-link">
                                <div class="mobile-nav-icon">
                                    <i class="fas fa-box"></i>
                                </div>
                                <span>My Orders</span>
                                <i class="fas fa-chevron-right"></i>
                            </a>
                            <a href="{% url 'frontend:wishlist' %}" class="mobile-nav-link">
                                <div class="mobile-nav-icon">
                                    <i class="fas fa-heart"></i>
                                </div>
                                <span>Wishlist</span>
                                <i class="fas fa-chevron-right"></i>
                            </a>
                            <a href="{% url 'frontend:cart' %}" class="mobile-nav-link">
                                <div class="mobile-nav-icon">
                                    <i class="fas fa-shopping-cart"></i>
                                </div>
                                <span>Shopping Cart</span>
                                <i class="fas fa-chevron-right"></i>
                            </a>
                        </div>
                        
                        <div class="mobile-nav-section">
                            <form action="{% url 'frontend:logout' %}" method="post" style="display:inline;" id="mobile-logout-form">
                                {% csrf_token %}
                                <a href="#" onclick="document.getElementById('mobile-logout-form').submit(); return false;" class="mobile-nav-link logout-link">
                                    <div class="mobile-nav-icon">
                                        <i class="fas fa-sign-out-alt"></i>
                                    </div>
                                    <span>Logout</span>
                                    <i class="fas fa-chevron-right"></i>
                                </a>
                            </form>
                        </div>
                    {% else %}
                        <div class="mobile-nav-section">
                            <h4 class="mobile-nav-title">Account</h4>
                            <a href="{% url 'frontend:login' %}" class="mobile-nav-link">
                                <div class="mobile-nav-icon">
                                    <i class="fas fa-sign-in-alt"></i>
                                </div>
                                <span>Login</span>
                                <i class="fas fa-chevron-right"></i>
                            </a>
                            <a href="{% url 'frontend:register' %}" class="mobile-nav-link">
                                <div class="mobile-nav-icon">
                                    <i class="fas fa-user-plus"></i>
                                </div>
                                <span>Register</span>
                                <i class="fas fa-chevron-right"></i>
                            </a>
                        </div>
                    {% endif %}
                </nav>
                
                <!-- Mobile Quick Actions -->
                <div class="mobile-quick-actions">
                    <h4 class="mobile-nav-title">Quick Actions</h4>
                    <div class="mobile-action-buttons">
                        <a href="{% url 'frontend:products' %}?featured=true" class="mobile-action-btn">
                            <i class="fas fa-fire"></i>
                            <span>Featured</span>
                        </a>
                        <a href="{% url 'frontend:products' %}?new=true" class="mobile-action-btn">
                            <i class="fas fa-sparkles"></i>
                            <span>New</span>
                        </a>
                        <a href="{% url 'frontend:products' %}?sale=true" class="mobile-action-btn">
                            <i class="fas fa-tags"></i>
                            <span>Sale</span>
                        </a>
                    </div>
                </div>
            </div>
            
            <!-- Mobile Menu Footer -->
            <div class="mobile-menu-footer">
                <div class="mobile-contact-info">
                    <div class="mobile-contact-item">
                        <i class="fas fa-phone"></i>
                        <span>{{ site_settings.contact_phone|default:'01777173040' }}</span>
                    </div>
                    <div class="mobile-contact-item">
                        <i class="fas fa-envelope"></i>
                        <span>{{ site_settings.contact_email|default:'contact@manobbazar.com' }}</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile Search Overlay -->
    <div class="mobile-search-overlay" id="mobileSearchOverlay">
        <div class="mobile-search-container">
            <div class="mobile-search-header">
                <h3 class="mobile-search-title">Search Products</h3>
                <button class="mobile-search-close" id="mobileSearchClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="mobile-search-form">
                <form method="get" action="{% url 'frontend:search' %}" class="mobile-search-form-inner">
                    <div class="mobile-search-input-group">
                        <input type="text" 
                               name="q" 
                               class="mobile-search-input" 
                               placeholder="What are you looking for?" 
                               autocomplete="off"
                               id="mobileSearchInput">
                        <button type="submit" class="mobile-search-submit">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                </form>
                
                <!-- Live Search Results -->
                <div class="mobile-search-results" id="mobileSearchResults" style="display: none;">
                    <!-- Results will be populated by JavaScript -->
                </div>
                
                <!-- Search Suggestions -->
                <div class="mobile-search-suggestions">
                    <h4 class="suggestions-title">Popular Searches</h4>
                    <div class="suggestion-tags">
                        <a href="{% url 'frontend:search' %}?q=wallet" class="suggestion-tag">Wallet</a>
                        <a href="{% url 'frontend:search' %}?q=long wallet" class="suggestion-tag">Long wallet</a>
                        <a href="{% url 'frontend:search' %}?q=belt" class="suggestion-tag">Belt</a>
                        <a href="{% url 'frontend:search' %}?q=short wallet" class="suggestion-tag">Short wallet</a>
                        <a href="{% url 'frontend:search' %}?q=Black" class="suggestion-tag">Black</a>
                        <a href="{% url 'frontend:search' %}?q=Chocolate" class="suggestion-tag">Chocolate</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>
