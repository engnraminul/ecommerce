{% load static %}

<!-- Professional Navbar -->
<header class="navbar-wrapper">
    <!-- Top Bar -->
    <div class="navbar-top">
        <div class="container">
            <div class="top-bar-content">
                <div class="top-bar-left">
                    <span class="contact-info">
                        <p><i class="fas fa-phone"></i> <a style="color: var(--light-color); text-decoration: none;" href="tel:{{ site_settings.contact_phone|default:'01777173040' }}">
                            {{ site_settings.contact_phone|default:"01777173040" }}
                        </a></p>
                        
                    </span>
                    <span class="contact-info">
                        <p><i class="fas fa-envelope"></i>  <a style="color: var(--light-color); text-decoration: none;" href="mailto:{{ site_settings.contact_email|default:'contact@manobbazar.com' }}">
                            {{ site_settings.contact_email|default:"contact@manobbazar.com" }}
                        </a>
                    </p>
                    </span>
                </div>
                <div class="top-bar-right">
                    <div class="language-selector">
                        <i class="fas fa-globe"></i>
                        <select>
                            <option>English</option>
                            <option>Spanish</option>
                            <option>French</option>
                        </select>
                    </div>
                    <div class="currency-selector">
                        <i class="fas fa-dollar-sign"></i>
                        <select>
                            <option>USD</option>
                            <option>EUR</option>
                            <option>GBP</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Navigation -->
    <nav class="navbar-main">
        <div class="container">
            <div class="navbar-content">
                <!-- Logo -->
                <div class="navbar-brand">
                    <a href="{% url 'frontend:home' %}" class="brand-logo">
                        <div class="main-logo">
                            <img src="{{ site_settings.site_logo }}" alt="{{ site_settings.site_name }}" style="max-height: 50px;">
                        </div>
                    </a>
                </div>

                <!-- Search Bar -->
                <div class="navbar-search">
                    <form class="search-form" method="get" action="{% url 'frontend:search' %}">
                        <div class="search-input-wrapper">
                            <div class="search-category">
                                <select name="category" class="category-select">
                                    <option value="">All Categories</option>
                                    {% for category in navbar_categories %}
                                    <option value="{{ category.slug }}">{{ category.name }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="search-divider"></div>
                            <input type="text" name="q" class="search-input" placeholder="Search for products..." value="{{ request.GET.q }}">
                            <button type="submit" class="search-button">
                                <i class="fas fa-search"></i>
                            </button>
                        </div>
                    </form>
                </div>

                <!-- User Actions -->
                <div class="navbar-actions">
                    <!-- User Account -->
                    <div class="action-item user-account">
                        {% if user.is_authenticated %}
                            <div class="user-dropdown">
                                <button class="user-trigger">
                                    <div class="user-avatar">
                                        {% if user.profile.avatar %}
                                            <img src="{{ user.profile.avatar.url }}" alt="Avatar">
                                        {% else %}
                                            <i class="fas fa-user"></i>
                                        {% endif %}
                                    </div>
                                    <div class="user-info">
                                        <span class="user-name">{{ user.first_name|default:user.username }}</span>
                                        <span class="user-role">My Account</span>
                                    </div>
                                    <i class="fas fa-chevron-down"></i>
                                </button>
                                <div class="user-menu">
                                    <a href="{% url 'frontend:dashboard' %}" class="menu-item">
                                        <i class="fas fa-tachometer-alt"></i> Dashboard
                                    </a>
                                    <a href="{% url 'frontend:profile' %}" class="menu-item">
                                        <i class="fas fa-user"></i> Profile
                                    </a>
                                    <a href="{% url 'frontend:orders' %}" class="menu-item">
                                        <i class="fas fa-box"></i> Orders
                                    </a>
                                    <a href="{% url 'frontend:wishlist' %}" class="menu-item">
                                        <i class="fas fa-heart"></i> Wishlist
                                    </a>
                                    <a href="#" class="menu-item">
                                        <i class="fas fa-cog"></i> Settings
                                    </a>
                                    <div class="menu-divider"></div>
                                    <form action="{% url 'frontend:logout' %}" method="post" style="display:inline;" id="dropdown-logout-form">
                                        {% csrf_token %}
                                        <a href="#" onclick="document.getElementById('dropdown-logout-form').submit(); return false;" class="menu-item logout">
                                            <i class="fas fa-sign-out-alt"></i> Logout
                                        </a>
                                    </form>
                                </div>
                            </div>
                        {% else %}
                            <div class="auth-buttons">
                                <a href="{% url 'frontend:login' %}" class="auth-btn login-btn">
                                    <i class="fas fa-sign-in-alt"></i>
                                    <span>Login</span>
                                </a>
                                <a href="{% url 'frontend:register' %}" class="auth-btn register-btn">
                                    <i class="fas fa-user-plus"></i>
                                    <span>Register</span>
                                </a>
                            </div>
                        {% endif %}
                    </div>

                    <!-- Wishlist -->
                    <div class="action-item wishlist">
                        <a href="{% url 'frontend:wishlist' %}" class="action-link">
                            <div class="action-icon">
                                <i class="fas fa-heart"></i>
                                <span class="action-badge wishlist-count" style="display: flex !important; visibility: visible !important; opacity: 1 !important;">0</span>
                            </div>
                            <div class="action-text">
                                <span class="action-label">Wishlist</span>
                                <span class="action-count wishlist-items">0 items</span>
                            </div>
                        </a>
                    </div>

                    <!-- Shopping Cart -->
                    <div class="action-item cart">
                        <a href="{% url 'frontend:cart' %}" class="action-link cart-link">
                            <div class="action-icon">
                                <i class="fas fa-shopping-cart"></i>
                                <span style="display: flex !important; visibility: visible !important; opacity: 1 !important;" class="action-badge cart-count">0</span>
                            </div>
                            <div class="action-text">
                                <span class="action-label">Cart</span>
                                <span class="action-count cart-total">à§³0.00</span>
                            </div>
                        </a>
                        
                        <!-- Cart Dropdown -->
                        <div class="cart-dropdown">
                            <div class="cart-dropdown-header">
                                <h4>Shopping Cart</h4>
                                <span class="cart-items-count">0 items</span>
                            </div>
                            <div class="cart-dropdown-body">
                                <div class="empty-cart">
                                    <i class="fas fa-shopping-cart"></i>
                                    <p>Your cart is empty</p>
                                    <a href="{% url 'frontend:products' %}" class="btn-shop-now">Shop Now</a>
                                </div>
                                <!-- Cart items will be loaded here via JavaScript -->
                            </div>
                            <div class="cart-dropdown-footer">
                                <div class="cart-total-display">
                                    <span>Total: <strong class="total-amount">à§³0.00</strong></span>
                                </div>
                                <div class="cart-actions">
                                    <a href="{% url 'frontend:cart' %}" class="btn btn-outline">View Cart</a>
                                    <a href="{% url 'frontend:checkout' %}" class="btn btn-primary">Checkout</a>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Mobile Menu Toggle -->
                    <div class="mobile-menu-toggle">
                        <button class="menu-toggle-btn">
                            <span class="hamburger"></span>
                            <span class="hamburger"></span>
                            <span class="hamburger"></span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Navigation Menu -->
    <div class="navbar-menu">
        <div class="container">
            <div class="menu-content">
                <!-- Category Menu -->
                <div class="category-menu">
                    <button class="category-trigger">
                        <i class="fas fa-bars"></i>
                        <span>All Categories</span>
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="category-dropdown">
                        <div class="category-list">
                            {% for category in navbar_categories %}
                            <a href="{% url 'frontend:category_products' category.slug %}" class="category-item">
                                {% if category.image_url %}
                                    <img src="{{ category.image_url }}" alt="{{ category.name }}" class="category-icon-image" style="width: 25px;">
                                {% else %}
                                    <i class="fas fa-tag"></i>
                                {% endif %}
                                <span>{{ category.name }}</span>
                                <i class="fas fa-chevron-right"></i>
                            </a>
                            {% empty %}
                            <div class="category-item">
                                <i class="fas fa-info-circle"></i>
                                <span>No categories available</span>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>

                <!-- Main Navigation Links -->
                <nav class="main-nav">
                    <ul class="nav-links">
                        <li class="nav-item">
                            <a href="{% url 'frontend:home' %}" class="nav-link {% if request.resolver_match.url_name == 'home' %}active{% endif %}">
                                Home
                            </a>
                        </li>
                        <li class="nav-item dropdown">
                            <a href="{% url 'frontend:products' %}" class="nav-link {% if request.resolver_match.url_name == 'products' %}active{% endif %}">
                                Products
                                <i class="fas fa-chevron-down"></i>
                            </a>
                            <div class="dropdown-menu">
                                <div class="dropdown-content">
                                    <div class="dropdown-section">
                                        <h5>Featured</h5>
                                        <a href="{% url 'frontend:products' %}?featured=true">Featured Products</a>
                                        <a href="{% url 'frontend:products' %}?new=true">New Arrivals</a>
                                        <a href="{% url 'frontend:products' %}?sale=true">Sale Items</a>
                                    </div>
                                    <div class="dropdown-section">
                                        <h5>Categories</h5>
                                        {% for category in navbar_categories|slice:":5" %}
                                        <a href="{% url 'frontend:category_products' category.slug %}">{{ category.name }}</a>
                                        {% endfor %}
                                        {% if navbar_categories|length > 5 %}
                                        <a href="{% url 'frontend:categories' %}">View All Categories</a>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                        </li>
                        <li class="nav-item">
                            <a href="{% url 'frontend:categories' %}" class="nav-link {% if request.resolver_match.url_name == 'categories' %}active{% endif %}">
                                Categories
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link">
                                Deals
                                <span class="nav-badge">HOT</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="{% url 'frontend:about' %}" class="nav-link {% if request.resolver_match.url_name == 'about' %}active{% endif %}">
                                About
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="{% url 'frontend:contact' %}" class="nav-link {% if request.resolver_match.url_name == 'contact' %}active{% endif %}">
                                Contact
                            </a>
                        </li>
                    </ul>
                </nav>

                <!-- Promotional Banner -->
                <div class="promo-banner">
                    <div class="promo-content">
                        <i class="fas fa-shipping-fast"></i>
                        <span>FREE SHIPPING on orders over à§³2000</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile Menu Overlay -->
    <div class="mobile-menu-overlay">
        <div class="mobile-menu">
            <div class="mobile-menu-header">
                <div class="brand-logo">
                    <div class="logo-icon">
                        <i class="fas fa-store"></i>
                    </div>
                    <div class="logo-text">
                        <span class="brand-name">StyleHub</span>
                        <span class="brand-tagline">Fashion Forward</span>
                    </div>
                </div>
                <button class="mobile-menu-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="mobile-menu-body">
                <!-- Mobile Search -->
                <form class="search-form" method="get" action="{% url 'frontend:search' %}">
                    <div class="search-input-wrapper">
                        <input type="text" class="search-input" name="q" placeholder="Search products..." value="{{ request.GET.q }}">
                        <button type="submit" class="search-button">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                </form>
                
                <!-- Mobile Navigation -->
                <nav class="mobile-nav">
                    <a href="{% url 'frontend:home' %}" class="mobile-nav-link">
                        <i class="fas fa-home"></i> Home
                    </a>
                    <a href="{% url 'frontend:products' %}" class="mobile-nav-link">
                        <i class="fas fa-shopping-bag"></i> Products
                    </a>
                    <a href="{% url 'frontend:categories' %}" class="mobile-nav-link">
                        <i class="fas fa-th-large"></i> Categories
                    </a>
                    <a href="#" class="mobile-nav-link">
                        <i class="fas fa-fire"></i> Deals
                    </a>
                    <a href="{% url 'frontend:about' %}" class="mobile-nav-link">
                        <i class="fas fa-info-circle"></i> About
                    </a>
                    <a href="{% url 'frontend:contact' %}" class="mobile-nav-link">
                        <i class="fas fa-envelope"></i> Contact
                    </a>
                    
                    {% if user.is_authenticated %}
                        <div class="menu-divider"></div>
                        <a href="{% url 'frontend:dashboard' %}" class="mobile-nav-link">
                            <i class="fas fa-tachometer-alt"></i> Dashboard
                        </a>
                        <a href="{% url 'frontend:profile' %}" class="mobile-nav-link">
                            <i class="fas fa-user"></i> Profile
                        </a>
                        <a href="{% url 'frontend:orders' %}" class="mobile-nav-link">
                            <i class="fas fa-box"></i> Orders
                        </a>
                        <a href="{% url 'frontend:wishlist' %}" class="mobile-nav-link">
                            <i class="fas fa-heart"></i> Wishlist
                        </a>
                        <form action="{% url 'frontend:logout' %}" method="post" style="display:inline;" id="mobile-logout-form">
                            {% csrf_token %}
                            <a href="#" onclick="document.getElementById('mobile-logout-form').submit(); return false;" class="mobile-nav-link">
                                <i class="fas fa-sign-out-alt"></i> Logout
                            </a>
                        </form>
                    {% else %}
                        <div class="menu-divider"></div>
                        <a href="{% url 'frontend:login' %}" class="mobile-nav-link">
                            <i class="fas fa-sign-in-alt"></i> Login
                        </a>
                        <a href="{% url 'frontend:register' %}" class="mobile-nav-link">
                            <i class="fas fa-user-plus"></i> Register
                        </a>
                    {% endif %}
                </nav>
            </div>
        </div>
    </div>
</header>
